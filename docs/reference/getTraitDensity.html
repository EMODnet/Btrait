<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="getTraitDensity combines (descriptor x taxon) density data with (taxon x trait) data to a (descriptor x trait) data set."><title>Functions for combining station x taxon and trait data. — Combining Density and Trait data • Btrait</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functions for combining station x taxon and trait data. — Combining Density and Trait data"><meta property="og:description" content="getTraitDensity combines (descriptor x taxon) density data with (taxon x trait) data to a (descriptor x trait) data set."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Btrait</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/Btrait.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BtraitData.html">Benthic density and trait databases in R-package Btrait</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Functions for combining station x taxon and trait data.</h1>
      
      <div class="d-none name"><code>getTraitDensity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>getTraitDensity</code> combines (descriptor x taxon) density data with (taxon x trait) data to a (descriptor x trait) data set.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getTraitDensity</span><span class="op">(</span><span class="va">descriptor</span>, <span class="va">taxon</span>, <span class="va">value</span>, averageOver <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>        wide <span class="op">=</span> <span class="cn">NULL</span>, d.column <span class="op">=</span> <span class="fl">1</span>, <span class="va">trait</span>, t.column <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        trait.class <span class="op">=</span> <span class="cn">NULL</span>, trait.score <span class="op">=</span> <span class="cn">NULL</span>, taxonomy <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>        scalewithvalue <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>descriptor </dt>
<dd><p>name(s) of the descriptor, i.e. *where* the data were taken, e.g. station names. Either a vector, a list, a data.frame or matrix (and with multiple columns). It can be of type numerical, character, or a factor. When a data.frame or a list the "names" will be used in the output; when a vector, the argument name will be used in the output.</p></dd>
    
  <dt>taxon </dt>
<dd><p>vector describing *what* the data are; it gives the taxonomic name (e.g. species). Should be of the same length as (the number of rows of) <code>descriptor</code>. Can be a list (or data.frame with one column), or a vector. When a data.frame or a list the "name" will be used in the output; when a vector, the argument name will be used.</p></dd>

  <dt>value </dt>
<dd><p>vector or list that contains the *values* of the data, usually density. Should be of the same length as (the number of rows of) <code>descriptor</code> and <code>taxon</code>. For function <code>getDensity</code>, <code>value</code> can also be a multi-column data.frame or matrix.</p></dd>

  <dt>averageOver </dt>
<dd><p>vector with *replicates* over which averages need to be taken. Should be of the same length as (the number of rows of) <code>descriptor</code>.</p></dd>

  <dt>wide </dt>
<dd><p>density data, in *WIDE* format. This is a data.frame or matrix with (descriptor x taxon) information. If <code>NULL</code>, this data.frame will be calculated from the <code>descriptor</code>, <code>taxon</code>, (<code>replicate</code>) and <code>value</code> data. The number of descriptor columns are specified with <code>d.column</code>. If a <code>data.frame</code> then the first column usually contains the descriptor name; in this case the dimensions of <code>wide</code> are (number of descriptors x number of species+1), and <code>d.column=1</code>. It is also allowed to have the descriptors as row.names of the data.frame -this requires setting <code>d.column=0</code>.</p></dd>

  <dt>trait </dt>
<dd><p>(taxon x trait) data or (descriptor x trait) data, in *WIDE* format, and containing numerical values only. Traits can be fuzzy coded. The number of columns with taxonomic information is specified with <code>t.column</code>. The default is to have the first column contain the name of the taxon, and <code>t.column=1</code>. It is also allowed to have the taxa as <code>row.names</code> of the data.frame; in this case, <code>t.column=0</code>. See last example for how to deal with cgtegorical traits.</p></dd>

  <dt>trait.class </dt>
<dd><p>indices to trait levels, a vector. The length of this vector should equal the number of columns of <code>trait</code> or <code>wide</code> minus the value of <code>t.column</code>. If present, this -together with <code>trait.score</code>- will be used to convert the trait matrix from fuzzy to crisp format.</p></dd>

  <dt>trait.score </dt>
<dd><p>trait values or scores, a vector. Should be of same length as <code>trait.class</code></p></dd>

  <dt>scalewithvalue </dt>
<dd><p>when TRUE, will standardize with respect to total density, so that the average trait value is obtained (not the summed value). Note that total density will be estimated only for those taxa whose traits are known.</p></dd>

  <dt>verbose </dt>
<dd><p>when TRUE, will write warnings to the screen.</p></dd>

  <dt>taxonomy </dt>
<dd><p>taxonomic information (the relationships between the taxa), a data.frame; first column will be matched with <code>taxon</code>, regardless of its name. This is used to estimate traits of taxa that are not accounted for, and that will be estimated based on taxa at the nearest taxonomic level. See details.</p></dd>

  <dt>d.column, t.column </dt>
<dd><p>position(s) or name(s) of the column(s) that holds the descriptor of the density data set (data.frame <code>wide</code>), and the taxa in the trait data set (data.frame <code>trait</code>). The default is to have the first column holding the descriptors or taxa. If <code>NULL</code>, or <code>0</code>, then there is no separate column with names, so the <code>row.names</code> of the dataset are used as descriptor or taxon names.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>The taxonomy is used to fill in the gaps of the trait information, assuming that closely related taxa will share similar traits. This is done in two steps:</p>
<p>The trait database is first extended with information on higher taxonomic levels (using *extendTrait*). The traits for a taxonomic level are estimated as the average of the traits at the lower level. For instance, traits on genus level will be averages of known traits of all species in the database belonging to this genus.</p>
<p>Then, for each taxon that is not present in the trait database, the traits on the closest taxonomic level are used. For instance, for an  unrecorded species, it is first checked if the trait is known on genus level, if not, family level and so on.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>getTraitDensity</code> returns the descriptor x trait density matrix.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
  Olivier Beauchard</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="MWTLdensitydata.html">MWTL</a> for the data sets.</p>
<p><a href="BtraitMap.html">mapBtrait</a> for simple plotting functions.</p>
<p><a href="densityfun.html">getDensity</a> for functions working with density data.</p>
<p><a href="getIndices.html">getDbIndex</a> for extracting bioturbation and bioirrigation indices.</p>
<p><a href="traitfun.html">extendTrait</a> for functions working with traits.</p>
<p><a href="traitfun.html">getTrait</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>When traits of certain taxa are not found, they are put equal to 0 and 
calculation will proceed; this will be notified only when <code>verbose</code> is set 
to <code>TRUE</code>. 
When that happens, the taxa that were ignored can be found in <code>attributes(..)$notrait</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## A small dataset with replicates</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2 stations, 2 replicates for st.a, one replicate for st.b</span></span></span>
<span class="r-in"><span><span class="va">Bdata.rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  station   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"st.a"</span>,<span class="st">"st.a"</span>,<span class="st">"st.a"</span>,<span class="st">"st.b"</span>,<span class="st">"st.b"</span>,<span class="st">"st.b"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  replicate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>     <span class="fl">1</span>,     <span class="fl">1</span>,    <span class="fl">2</span>,     <span class="fl">1</span>,     <span class="fl">1</span>,     <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  species   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.1"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.4"</span>,<span class="st">"sp.5"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  density   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>     <span class="fl">1</span>,     <span class="fl">2</span>,    <span class="fl">3</span>,     <span class="fl">3</span>,     <span class="fl">1</span>,     <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Bdata.rep</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station replicate species density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    st.a         1    sp.1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    st.a         1    sp.2       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    st.a         2    sp.1       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    st.b         1    sp.3       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    st.b         1    sp.4       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    st.b         1    sp.5       3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## From long to wide format, averaging over replicates</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Bwide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu"><a href="long2wide.html">l2wDensity</a></span> <span class="op">(</span>value      <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>             descriptor  <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>             averageOver <span class="op">=</span> <span class="va">replicate</span>,</span></span>
<span class="r-in"><span>             taxon       <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Bwide</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor sp.1 sp.2 sp.3 sp.4 sp.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a    2    1    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b    0    0    3    1    3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Small dataset: fuzzy-coded traits</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note: no data for "sp.4"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Btraits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  taxon   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.5"</span>,<span class="st">"sp.6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  T1_M1   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>     , <span class="fl">0</span>    ,   <span class="fl">0</span>  , <span class="fl">0.2</span>  ,     <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  T1_M2   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>     , <span class="fl">0</span>    , <span class="fl">0.5</span>  , <span class="fl">0.3</span>  ,     <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  T1_M3   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>     , <span class="fl">1</span>    , <span class="fl">0.5</span>  , <span class="fl">0.5</span>  ,     <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  T2_M1   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>     , <span class="fl">0</span>    ,   <span class="fl">1</span>  , <span class="fl">0.5</span>  ,     <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  T2_M2   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>     , <span class="fl">1</span>    ,   <span class="fl">0</span>  , <span class="fl">0.5</span>  ,     <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The metadata for this trait</span></span></span>
<span class="r-in"><span><span class="va">Btraits.lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  colname  <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T1_M1"</span>,<span class="st">"T1_M2"</span>,<span class="st">"T1_M3"</span>,<span class="st">"T2_M1"</span>,<span class="st">"T2_M2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  trait    <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T1"</span>   ,<span class="st">"T1"</span>   ,<span class="st">"T1"</span>   ,<span class="st">"T2"</span>   ,<span class="st">"T2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  modality <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M1"</span>   ,<span class="st">"M2"</span>   ,<span class="st">"M3"</span>   ,<span class="st">"M1"</span>   ,<span class="st">"M2"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  score    <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>      , <span class="fl">0.5</span>   , <span class="fl">1</span>     , <span class="fl">0.2</span>   , <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Small dataset: taxonomy</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Btaxonomy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.4"</span>,<span class="st">"sp.5"</span>,<span class="st">"sp.6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  genus   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"g.1"</span>, <span class="st">"g.2"</span>, <span class="st">"g.2"</span>, <span class="st">"g.2"</span>, <span class="st">"g.3"</span>, <span class="st">"g.4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  family  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.2"</span>, <span class="st">"f.3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  order   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.2"</span>, <span class="st">"o.2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  class   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Community weighted mean score</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># if verbose=TRUE, a warning will be given, as there is no trait information</span></span></span>
<span class="r-in"><span><span class="co"># for sp4 - this affects the trait density for station "b"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cwm.trait</span> <span class="op">&lt;-</span> <span class="fu">getTraitDensity</span> <span class="op">(</span></span></span>
<span class="r-in"><span>                        wide           <span class="op">=</span> <span class="va">Bwide</span>,  </span></span>
<span class="r-in"><span>                        trait          <span class="op">=</span> <span class="va">Btraits</span>, </span></span>
<span class="r-in"><span>                        trait.class    <span class="op">=</span> <span class="va">Btraits.lab</span><span class="op">$</span><span class="va">trait</span>, </span></span>
<span class="r-in"><span>                        trait.score    <span class="op">=</span> <span class="va">Btraits.lab</span><span class="op">$</span><span class="va">score</span>, </span></span>
<span class="r-in"><span>                        scalewithvalue <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>                        verbose        <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cwm.trait</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor        T1   T2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a 0.6666667 2.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b 0.7000000 0.65</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">cwm.trait</span><span class="op">)</span><span class="op">$</span><span class="va">notrait</span>   <span class="co"># species that was ignored</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sp.4"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same, but total trait values</span></span></span>
<span class="r-in"><span><span class="va">cwm.trait.2</span> <span class="op">&lt;-</span> <span class="fu">getTraitDensity</span> <span class="op">(</span></span></span>
<span class="r-in"><span>                        wide           <span class="op">=</span> <span class="va">Bwide</span>,  </span></span>
<span class="r-in"><span>                        trait          <span class="op">=</span> <span class="va">Btraits</span>, </span></span>
<span class="r-in"><span>                        trait.class    <span class="op">=</span> <span class="va">Btraits.lab</span><span class="op">$</span><span class="va">trait</span>, </span></span>
<span class="r-in"><span>                        trait.score    <span class="op">=</span> <span class="va">Btraits.lab</span><span class="op">$</span><span class="va">score</span>, </span></span>
<span class="r-in"><span>                        scalewithvalue <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>                        verbose        <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cwm.trait.2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor  T1  T2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a 2.0 6.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b 4.2 3.9</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Traits from all taxa in the dataset, including high-level information </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cwm.trait.2</span> <span class="op">&lt;-</span> <span class="fu">getTraitDensity</span> <span class="op">(</span></span></span>
<span class="r-in"><span>                        wide           <span class="op">=</span> <span class="va">Bwide</span>,  </span></span>
<span class="r-in"><span>                        trait          <span class="op">=</span> <span class="va">Btraits</span>, </span></span>
<span class="r-in"><span>                        trait.class    <span class="op">=</span> <span class="va">Btraits.lab</span><span class="op">$</span><span class="va">trait</span>, </span></span>
<span class="r-in"><span>                        trait.score    <span class="op">=</span> <span class="va">Btraits.lab</span><span class="op">$</span><span class="va">score</span>, </span></span>
<span class="r-in"><span>                        taxonomy       <span class="op">=</span> <span class="va">Btaxonomy</span>,</span></span>
<span class="r-in"><span>                        scalewithvalue <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cwm.trait.2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor        T1        T2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a 0.6666667 2.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b 0.7250000 0.7142857</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">cwm.trait.2</span><span class="op">)</span><span class="op">$</span><span class="va">notrait</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same but keeping fuzzy scores</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cwm.trait.3</span> <span class="op">&lt;-</span> <span class="fu">getTraitDensity</span> <span class="op">(</span></span></span>
<span class="r-in"><span>                        wide           <span class="op">=</span> <span class="va">Bwide</span>,  </span></span>
<span class="r-in"><span>                        trait          <span class="op">=</span> <span class="va">Btraits</span>, </span></span>
<span class="r-in"><span>                        taxonomy       <span class="op">=</span> <span class="va">Btaxonomy</span>,</span></span>
<span class="r-in"><span>                        scalewithvalue <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cwm.trait.3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor      T1_M1     T1_M2     T1_M3     T2_M1     T2_M2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a 0.00000000 0.6666667 0.3333333 0.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b 0.08571429 0.3785714 0.5357143 0.7142857 0.2857143</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## categorical traits</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note: no data for "sp.4"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Bcategory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  taxon   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.5"</span>,<span class="st">"sp.6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  C1      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="st">"A"</span>,   <span class="st">"B"</span>,   <span class="st">"A"</span>,   <span class="st">"C"</span>,   <span class="st">"C"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># this will not work, as trait should be numerical</span></span></span>
<span class="r-in"><span><span class="va">cwm.trait.4</span> <span class="op">&lt;-</span> <span class="fu">getTraitDensity</span> <span class="op">(</span></span></span>
<span class="r-in"><span>                        wide           <span class="op">=</span> <span class="va">Bwide</span>,  </span></span>
<span class="r-in"><span>                        trait          <span class="op">=</span> <span class="va">Bcategory</span>, </span></span>
<span class="r-in"><span>                        taxonomy       <span class="op">=</span> <span class="va">Btaxonomy</span>,</span></span>
<span class="r-in"><span>                        scalewithvalue <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="traitfun.html">crisp2fuzzy</a></span><span class="op">(</span><span class="va">Bcategory</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   taxon C1_A C1_B C1_C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  sp.1    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  sp.2    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  sp.3    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  sp.5    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  sp.6    0    0    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this will  work, as categorical traits -&gt; numerical</span></span></span>
<span class="r-in"><span><span class="va">cwm.trait.4</span> <span class="op">&lt;-</span> <span class="fu">getTraitDensity</span> <span class="op">(</span></span></span>
<span class="r-in"><span>                        wide           <span class="op">=</span> <span class="va">Bwide</span>,  </span></span>
<span class="r-in"><span>                        trait          <span class="op">=</span> <span class="fu"><a href="traitfun.html">crisp2fuzzy</a></span><span class="op">(</span><span class="va">Bcategory</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                        taxonomy       <span class="op">=</span> <span class="va">Btaxonomy</span>,</span></span>
<span class="r-in"><span>                        scalewithvalue <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cwm.trait.4</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor      C1_A       C1_B      C1_C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a 0.6666667 0.33333333 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b 0.5000000 0.07142857 0.4285714</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Karline Soetaert.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

