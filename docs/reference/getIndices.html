<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="getDbIndex estimates the BPc index sensu Querios et al., 2013 and Solan et al., 2004.
getIrrIndex estimates the IPc index sensu Wrede et al., 2018."><title>Functions for obtaining the bioturbation and bio-irrigation potential index. — Bioturbation and Bioirrigation potential indices • Btrait</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functions for obtaining the bioturbation and bio-irrigation potential index. — Bioturbation and Bioirrigation potential indices"><meta property="og:description" content="getDbIndex estimates the BPc index sensu Querios et al., 2013 and Solan et al., 2004.
getIrrIndex estimates the IPc index sensu Wrede et al., 2018."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Btrait</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/Btrait.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BtraitData.html">Benthic density and trait databases in R-package Btrait</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Functions for obtaining the bioturbation and bio-irrigation potential index.</h1>
      
      <div class="d-none name"><code>getIndices.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>getDbIndex</code> estimates the BPc index sensu Querios et al., 2013 and Solan et al., 2004.</p>
<p><code>getIrrIndex</code> estimates the IPc index sensu Wrede et al., 2018.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getDbIndex</span> <span class="op">(</span><span class="va">descriptor</span>, <span class="va">taxon</span>, <span class="va">density</span>, <span class="va">biomass</span>, averageOver <span class="op">=</span> <span class="cn">NULL</span>,    </span>
<span>       <span class="va">subset</span>, trait <span class="op">=</span> <span class="va">Traits_Db</span>, taxonomy <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>       full.output <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">getIrrIndex</span> <span class="op">(</span><span class="va">descriptor</span>, <span class="va">taxon</span>, <span class="va">density</span>, <span class="va">biomass</span>, averageOver <span class="op">=</span> <span class="cn">NULL</span>,    </span>
<span>       <span class="va">subset</span>, trait <span class="op">=</span> <span class="va">Traits_irr</span>, taxonomy <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>       full.output <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>descriptor </dt>
<dd><p>name(s) of the descriptor, i.e. *where* the data were taken, e.g. station names. Either a vector, a list, a data.frame or matrix (and with multiple columns). It can be of type numerical, character, or a factor. When a data.frame or a list the "names" will be used in the output; when a vector, the argument name will be used in the output.</p></dd>
    
  <dt>taxon </dt>
<dd><p>vector describing *what* the data are; it gives the taxonomic name (e.g. species). Should be of the same length as (the number of rows of) <code>descriptor</code>. Can be a list (or data.frame with one column), or a vector. When a data.frame or a list the "name" will be used in the output; when a vector, the argument name will be used.</p></dd>

  <dt>density, biomass </dt>
<dd><p>vector or list that contains the *density* and *biomass* of the data. Should be of the same length as (the number of rows of) <code>descriptor</code> and <code>taxon</code>.</p></dd>

  <dt>averageOver </dt>
<dd><p>vector with *replicates* over which averages need to be taken. Should be of the same length as (the number of rows of) <code>descriptor</code>.</p></dd>

  <dt>subset </dt>
<dd><p>logical expression indicating elements to keep from the density data: missing values are taken as FALSE. If NULL, or absent, then all elements are used. Note that the subset is taken *after* the number of samples to average per descriptor is calculated, so this will also work for selecting certain taxa that may not be present in all replicates over which should be averaged.</p></dd>

  <dt>trait </dt>
<dd><p>(taxon x trait) data, in *WIDE* format, and containing numerical values only. The first column should contain the name of the taxa. For function <code>getDbIndex</code>, also the columns named <code>Mi</code> and <code>Ri</code>, denoting the mobility and reworking mode (values between 1-4 and 1-5 respectively) should be present. For function <code>getIrrIndex</code>, the columns named <code>BT</code> (burrowtype, 1-3), <code>FT</code> (feeding type, 1-3), and <code>ID</code> (injection depth, 1-4) should be present. Good choices are <a href="Btraitdata.html">Traits_Db</a> and <a href="Btraitdata.html">Traits_irr</a> (the defaults).</p></dd>

  <dt>verbose </dt>
<dd><p>when TRUE, will write warnings to the screen.</p></dd>

  <dt>full.output </dt>
<dd><p>when TRUE, will output the full data.frame with the descriptor x taxon indices (called <code>all</code>. See <code>value</code>.</p></dd>

  <dt>taxonomy </dt>
<dd><p>taxonomic information (the relationships between the taxa), a data.frame; first column will be matched with <code>taxon</code>, regardless of its name. This is used to estimate traits of taxa that are not accounted for, and that will be estimated based on taxa at the nearest taxonomic level. See details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The algorithm first calls function <code>getDensity</code>, to obtain the (depending on <code>averageOver</code> averaged) taxon densities and biomass per descriptor. The weight is estimated from biomass and density.</p>
<p>Then, for each taxon in the obtained dataset, the required traits are extracted from the trait database using function <code>getTrait</code>.</p>
<p>The two data.frames are then merged (based on taxon), so that for each descriptor x taxon occurrence, the density, weight and required traits.</p>
<p>The bioturbation or bioirrigation Index is then estimated by using the appropriate formula,</p>
<p>Finally, the sums of the taxon indices are taken per descriptor, and the averages are estimated for the taxa, using the R-function <code>aggregate</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Both return a <code>list</code> with the following elements:</p>
<p></p>
<ul><li><p>descriptor a data.frame with two columns, the descriptor, and the index (BPc or IPc), 
    which consist of the *summed* values over all taxa</p></li>
<li><p>taxon a data.frame with two columns, the taxon name, and the index (BPc or IPc), 
    which is *averaged* over all descriptors</p></li>
<li><p>all, will only be present if <code>full.output</code> is <code>TRUE</code>: the full dataset on which the indices were estimated.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="MWTLdensitydata.html">MWTL</a> for the data sets</p>
<p><a href="BtraitMap.html">mapBtrait</a> for simple plotting functions</p>
<p><a href="densityfun.html">getDensity</a> for functions working with density data</p>
<p><a href="getTraitDensity.html">getTraitDensity</a> for functions operating on density and trait data.</p>
<p><a href="traitfun.html">extendTrait</a> for functions working with traits</p>
<p><a href="traitfun.html">getTrait</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Queiros, Ana M., Silvana N. R. Birchenough, Julie Bremner, Jasmin A. Godbold, Ruth E. Parker,  Alicia Romero-Ramirez, Henning Reiss, Martin Solan, Paul J. Somerfield, Carl Van Colen,  Gert Van Hoey, Stephen Widdicombe, 2013.  A bioturbation classification of European marine infaunal invertebrates.  Ecology and Evolution 3 (11), 3958-3985</p>
<p>Solan M, Cardinale BJ, Downing AL, Engelhardt KAM, Ruesink JL, Srivastava DS. 2004. Extinction and ecosystem function in the marine benthos. Science 306:1177-80.</p>
<p>A. Wrede, J.Beermann, J.Dannheim, L.Gutow, T.Brey, 2018. Organism functional traits and ecosystem supporting services - A novel approach to predict bioirrigation. Ecological indicators, 91, 737-743.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Equations:</p><ul><li><p>The formula for estimating the bioturbation Index for taxon i (as in Querios et al., 2013)is:</p>
<p>BPc_i = sqrt(Wi) * density_i * Ri*Mi,</p>
<p>where <code>Mi</code> and <code>Ri</code>, denote the mobility and reworking mode (values between 1-4 and 1-5 respectively). See <a href="Btraitdata.html">Traits_Db</a> for what these numbers mean.</p></li>
<li><p>The formula for estimating the bioirrigation Index for taxon i (as in Wrede et al., 2018) is:</p>
<p>IPc_i = (Wi)^(0.75) * density_i * BTi*FTi*IDi,</p>
<p>where <code>BT</code> is burrowtype (1-3), <code>FT</code>  is feeding type (1-3), and <code>ID</code> is injection depth (BF1-4).
See <a href="Btraitdata.html">Traits_irr</a> for what these numbers mean.</p></li>
</ul><p>The stations Index is the sum of all species indices.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## The bioturbation potential for one species</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Amphiura filiformis, for increasing density </span></span></span>
<span class="r-in"><span><span class="va">DbAmp</span> <span class="op">&lt;-</span> <span class="fu">getDbIndex</span><span class="op">(</span></span></span>
<span class="r-in"><span>              taxon   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Amphiura filiformis"</span>, times<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              density <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, </span></span>
<span class="r-in"><span>              biomass <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">*</span><span class="fl">4.5e-3</span>, </span></span>
<span class="r-in"><span>              full.output<span class="op">=</span><span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>              trait   <span class="op">=</span> <span class="va">Traits_Db</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DbAmp</span><span class="op">$</span><span class="va">all</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 taxon descriptor density biomass Weight Ri Mi       BPc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Amphiura filiformis          1       1  0.0045 0.0045  4  3 0.8049845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Amphiura filiformis          2       2  0.0090 0.0045  4  3 1.6099689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Amphiura filiformis          3       3  0.0135 0.0045  4  3 2.4149534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Amphiura filiformis          4       4  0.0180 0.0045  4  3 3.2199379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Amphiura filiformis          5       5  0.0225 0.0045  4  3 4.0249224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 Amphiura filiformis          6       6  0.0270 0.0045  4  3 4.8299068</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## The bioirrigation potential for one species</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Amphiura filiformis, in dutch part of the northsea </span></span></span>
<span class="r-in"><span><span class="va">IrrAmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">density</span>, </span></span>
<span class="r-in"><span>     <span class="fu">getIrrIndex</span><span class="op">(</span></span></span>
<span class="r-in"><span>              descriptor  <span class="op">=</span> <span class="va">station</span>,         </span></span>
<span class="r-in"><span>              taxon       <span class="op">=</span> <span class="va">taxon</span>, </span></span>
<span class="r-in"><span>              subset      <span class="op">=</span> <span class="va">taxon</span> <span class="op">==</span> <span class="st">"Amphiura filiformis"</span>, </span></span>
<span class="r-in"><span>              averageOver <span class="op">=</span> <span class="va">year</span>,</span></span>
<span class="r-in"><span>              density     <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>              biomass     <span class="op">=</span> <span class="va">biomass</span>, </span></span>
<span class="r-in"><span>              full.output <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>              trait       <span class="op">=</span> <span class="va">Traits_irr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># irrigation activity per station</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">IrrAmp</span><span class="op">$</span><span class="va">descriptor</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor        IPc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  BREEVTN02 3.39001010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  BREEVTN26 0.57202895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  BREEVTN34 1.56014062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   DOGGBK02 0.89370665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   DOGGBK03 0.22054641</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   DOGGBK04 0.03289779</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add coordinates of the stations</span></span></span>
<span class="r-in"><span><span class="va">IRR.amphiura</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">stations</span>, <span class="va">IrrAmp</span><span class="op">$</span><span class="va">descriptor</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a map</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">IRR.amphiura</span>, <span class="fu"><a href="BtraitMap.html">mapBtrait</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, colvar<span class="op">=</span><span class="va">IPc</span>, pch<span class="op">=</span><span class="fl">18</span>,</span></span>
<span class="r-in"><span>                     contours<span class="op">=</span><span class="va">MWTL</span><span class="op">$</span><span class="va">contours</span>, draw.levels<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="getIndices-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>                     </span></span>
<span class="r-in"><span><span class="va">IrrAmp</span><span class="op">$</span><span class="va">taxon</span>  <span class="co"># average irrigation activity</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 taxon     IPc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Amphiura filiformis 56.0902</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## The bioturbation potential index for communities</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># BPc = sqrt(weight) * density * Mi * Ri</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># BPc for the Dutch part of the Northsea, in 1995</span></span></span>
<span class="r-in"><span><span class="va">BPC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">density</span>,</span></span>
<span class="r-in"><span>      <span class="fu">getDbIndex</span><span class="op">(</span>descriptor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>station<span class="op">=</span><span class="va">station</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     subset     <span class="op">=</span> <span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">1995</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     taxon      <span class="op">=</span> <span class="va">taxon</span>, </span></span>
<span class="r-in"><span>                     density    <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>                     biomass    <span class="op">=</span> <span class="va">biomass</span>, </span></span>
<span class="r-in"><span>                     trait      <span class="op">=</span> <span class="va">Traits_Db</span>,      </span></span>
<span class="r-in"><span>                     taxonomy   <span class="op">=</span> <span class="va">Taxonomy</span><span class="op">)</span><span class="op">)</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># There is one taxon for which trait could not be derived</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">BPC</span><span class="op">)</span><span class="op">$</span><span class="va">notrait</span>  </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Entoprocta"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Total BPC per station</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">BPC</span><span class="op">$</span><span class="va">descriptor</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     station      BPc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 BREEVTN02 627.3342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 BREEVTN03 254.4773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 BREEVTN04 367.8208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 BREEVTN05 292.6285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 BREEVTN06 278.8084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 BREEVTN07 343.3364</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Average BPC per taxon (only where taxon is present)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">BPC</span><span class="op">$</span><span class="va">taxon</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   taxon        BPc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             Abra alba  11.837624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       Abra prismatica   7.703744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     Acidostoma obesum   2.770155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Acrocnida brachiata 170.679651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Ampelisca brevicornis   1.189973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Ampelisca tenuicornis   1.511491</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the results (after adding the coordinates)</span></span></span>
<span class="r-in"><span><span class="va">BPC_MWTL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">stations</span>, <span class="va">BPC</span><span class="op">$</span><span class="va">descriptor</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">BPC_MWTL</span>, <span class="fu"><a href="BtraitMap.html">mapBtrait</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, colvar<span class="op">=</span><span class="va">BPc</span>, pch<span class="op">=</span><span class="fl">18</span>, </span></span>
<span class="r-in"><span>       contours<span class="op">=</span><span class="va">MWTL</span><span class="op">$</span><span class="va">contours</span>, draw.levels<span class="op">=</span><span class="cn">TRUE</span>, main<span class="op">=</span> <span class="st">"BPc"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="getIndices-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The 10 main bioturbators in the data set:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">BPC</span><span class="op">$</span><span class="va">taxon</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">BPC</span><span class="op">$</span><span class="va">taxon</span><span class="op">$</span><span class="va">BPc</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   taxon       BPc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Amphiura filiformis 549.47920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24          Callianassa 284.34819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43           Ensis leei 266.91010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38        Echinocardium 266.41715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Acrocnida brachiata 170.67965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141 Spisula subtruncata 133.51702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89             Magelona 126.64536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 153   Upogebia deltaura 114.46170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  Brissopsis lyrifera 103.86270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44        Ensis siliqua  91.17133</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## The bioirrigation Index</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># IPc = (weight_i)^0.75 * density * FTi * BTi * IDi</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># IPc for the NSBS station OESTGDN19 in the OysterGrounds</span></span></span>
<span class="r-in"><span><span class="va">IPC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">density</span>,</span></span>
<span class="r-in"><span>      <span class="fu">getIrrIndex</span><span class="op">(</span>descriptor  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>station<span class="op">=</span><span class="va">station</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  subset      <span class="op">=</span> <span class="op">(</span><span class="va">station</span> <span class="op">==</span> <span class="st">"OESTGDN19"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  taxon       <span class="op">=</span> <span class="va">taxon</span>, </span></span>
<span class="r-in"><span>                  averageOver <span class="op">=</span> <span class="va">year</span>,</span></span>
<span class="r-in"><span>                  density     <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>                  biomass     <span class="op">=</span> <span class="va">biomass</span>, </span></span>
<span class="r-in"><span>                  trait       <span class="op">=</span> <span class="va">Traits_irr</span>,      </span></span>
<span class="r-in"><span>                  taxonomy    <span class="op">=</span> <span class="va">Taxonomy</span>,</span></span>
<span class="r-in"><span>                  full.output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The 10 main bioirrigators in the data set, and why :</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">IPC</span><span class="op">$</span><span class="va">all</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">IPC</span><span class="op">$</span><span class="va">all</span><span class="op">$</span><span class="va">IPc</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        taxon   station    density   biomass      Weight</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31             Echinocardium OESTGDN19  12.355175 7.6178121 0.616568521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63     Notomastus latericeus OESTGDN19  27.258948 1.2724267 0.046679231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55                  Magelona OESTGDN19 386.563533 0.3492551 0.000903487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62                   Nephtys OESTGDN19  48.488303 0.6977140 0.014389326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9        Amphiura filiformis OESTGDN19 163.526663 0.7331815 0.004483559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19               Callianassa OESTGDN19  10.891484 0.2309406 0.021203780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96         Thyasira flexuosa OESTGDN19 210.743760 0.2532416 0.001201657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         Lanice conchilega OESTGDN19   8.884480 0.5046557 0.056801933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86        Sigalion mathildae OESTGDN19  31.626840 0.2567129 0.008116931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Chaetopterus variopedatus OESTGDN19   2.033738 0.6440768 0.316696025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          BT   FT   ID        IPc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 1.500000 3.00 3.40 131.530463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63 2.000000 3.00 4.00  65.699657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55 2.000000 2.75 3.00  33.238870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62 3.000000 1.40 3.25  27.497928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  1.500000 2.50 2.50  26.562996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 2.500000 3.00 4.00  18.155920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96 1.714286 2.00 3.00  13.990217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53 1.500000 2.50 3.40  13.179974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86 3.000000 1.00 4.00  10.263156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 1.333333 2.00 4.00   9.158107</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Karline Soetaert.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

