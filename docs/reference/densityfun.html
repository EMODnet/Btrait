<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="getDensity takes a subset of density data, possibly at higher taxonomic level.
getProportion estimates proportional values from (a subset of) density data.
addAbsences adds taxon absences in density data in long format."><title>Functions for working with station x taxon data. — Density functions • Btrait</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functions for working with station x taxon data. — Density functions"><meta property="og:description" content="getDensity takes a subset of density data, possibly at higher taxonomic level.
getProportion estimates proportional values from (a subset of) density data.
addAbsences adds taxon absences in density data in long format."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Btrait</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/Btrait.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BtraitData.html">Benthic density and trait databases in R-package Btrait</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Functions for working with station x taxon data.</h1>
      
      <div class="d-none name"><code>densityfun.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>getDensity</code> takes a subset of density data, possibly at higher taxonomic level.</p>
<p><code>getProportion</code> estimates proportional values from (a subset of) density data.</p>
<p><code>addAbsences</code> adds taxon absences in density data in long format.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getDensity</span><span class="op">(</span><span class="va">descriptor</span>, <span class="va">taxon</span>, <span class="va">value</span>, averageOver <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>        taxonomy <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">subset</span>, wide.output <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>        full.output <span class="op">=</span> <span class="cn">FALSE</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">getProportion</span><span class="op">(</span><span class="va">descriptor</span>, <span class="va">taxon</span>, <span class="va">value</span>, averageOver <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>        taxonomy <span class="op">=</span> <span class="cn">NULL</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">addAbsences</span><span class="op">(</span><span class="va">descriptor</span>, <span class="va">taxon</span>, <span class="va">value</span>, averageOver <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>descriptor </dt>
<dd><p>name(s) of the descriptor, i.e. *where* the data were taken, e.g. station names. Either a vector, a list, a data.frame or matrix (and with multiple columns). It can be of type numerical, character, or a factor. When a data.frame or a list the "names" will be used in the output; when a vector, the argument name will be used in the output. In theory, this could also be one number or <code>NA</code>; however, care needs to be taken in case this combined with <code>subset</code> and <code>averageOver</code></p></dd>
    
  <dt>taxon </dt>
<dd><p>vector describing *what* the data are; it gives the taxonomic name (e.g. species). Should be of the same length as (the number of rows of) <code>descriptor</code>. Can be a list (or data.frame with one column), or a vector. When a data.frame or a list the "name" will be used in the output; when a vector, the argument name will be used.</p></dd>

  <dt>value </dt>
<dd><p>vector or list that contains the *values* of the data, usually density. Should be of the same length as (the number of rows of) <code>descriptor</code> and <code>taxon</code>. For function <code>getDensity</code>, <code>value</code> can also be a multi-column data.frame or matrix.</p></dd>

  <dt>averageOver </dt>
<dd><p>vector with *replicates* over which averages need to be taken. Should be of the same length as (the number of rows of) <code>descriptor</code>.</p></dd>

  <dt>subset </dt>
<dd><p>logical expression indicating elements to keep: missing values are taken as FALSE. If NULL, or absent, then all elements are used. Note that the subset is taken *after* the number of samples to average per descriptor is calculated, so this will also work for selecting certain taxa that may not be present in all replicates over which should be averaged.</p></dd>

  <dt>taxonomy </dt>
<dd><p>taxonomic information; first column will be matched with <code>taxon</code>, regardless of its name.</p></dd>

  <dt>full.output </dt>
<dd><p>when TRUE, will also return descriptors for which the value is 0. This can be relevant in case a selection is made for taxonomic composition. Note that the taxon in this case will be undefined.</p></dd>

  <dt>wide.output </dt>
<dd><p>when TRUE, will recast the output in wide format (the default is long format). This only makes sense when <code>value</code> has multiple columns. In the wide format, each row holds the taxa for a descriptor, and each column holds the values for one taxon and all descriptors.</p></dd>

  <dt>verbose </dt>
<dd><p>when TRUE, may write warnings to the screen.</p></dd>
  
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<ul><li><p><code>getDensity</code> returns a <code>data.frame</code> combining descriptor, taxon, and value, in LONG format.</p> 
<p>Unless argument <code>full.output</code> is <code>TRUE</code>, this will not contain absences 
 (i.e. where value = 0), unless they were already present in the input.</p>
<p>The <code>value</code> consists of summed values for (<code>descriptor</code>, <code>averageOver</code>, 
  <code>taxon</code>) combinations, followed by averaging over <code>averageOver</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
  Olivier Beauchard</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="MWTLdensitydata.html">MWTL</a> for the data sets.</p>
<p><a href="BtraitMap.html">mapBtrait</a> for simple plotting functions.</p>
<p><a href="long2wide.html">long2wide</a> for estimating converting data from long to wide format and vice versa.</p>
<p><a href="summary.html">getSummary</a> for estimating summaries from density data.</p>
<p><a href="getTraitDensity.html">getTraitDensity</a> for functions combining density and traits.</p>
<p><a href="traitfun.html">extendTrait</a> for functions working with traits.</p>
<p><a href="getIndices.html">getDbIndex</a> for extracting bioturbation and bioirrigation indices.</p></div>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<ul><li><p><code>getDensity</code>. In this function a summed <code>value</code> over 
    <code>taxa</code> x <code>descriptor</code> is first calculated, and this value is then 
    divided by the number of replicates (as in <code>averageOver</code>) per <code>descriptor</code>.</p>    
<p>This is suitable for density and biomass data, but NOT for mean individual weight for instance.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## A small dataset with replicates</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2 stations, 2 replicates for st.a, one replicate for st.b</span></span></span>
<span class="r-in"><span><span class="va">Bdata.rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  station   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"st.a"</span>,<span class="st">"st.a"</span>,<span class="st">"st.a"</span>,<span class="st">"st.b"</span>,<span class="st">"st.b"</span>,<span class="st">"st.b"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  replicate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>     <span class="fl">1</span>,     <span class="fl">1</span>,    <span class="fl">2</span>,     <span class="fl">1</span>,     <span class="fl">1</span>,     <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  species   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.1"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.4"</span>,<span class="st">"sp.5"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  density   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>     <span class="fl">1</span>,     <span class="fl">2</span>,    <span class="fl">3</span>,     <span class="fl">3</span>,     <span class="fl">1</span>,     <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Bdata.rep</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station replicate species density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    st.a         1    sp.1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    st.a         1    sp.2       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    st.a         2    sp.1       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    st.b         1    sp.3       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    st.b         1    sp.4       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    st.b         1    sp.5       3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Proportion of each species</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">getProportion</span> <span class="op">(</span>value       <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>                 descriptor  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">station</span>, <span class="va">replicate</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                 taxon       <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station replicate taxon         p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    st.a         1  sp.1 0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    st.a         1  sp.2 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    st.a         2  sp.1 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    st.b         1  sp.3 0.4285714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    st.b         1  sp.4 0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    st.b         1  sp.5 0.4285714</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## average of replicates</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">getDensity</span> <span class="op">(</span>value       <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>              descriptor  <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>              taxon       <span class="op">=</span> <span class="va">species</span>, </span></span>
<span class="r-in"><span>              averageOver <span class="op">=</span> <span class="va">replicate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor taxon value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a  sp.1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.a  sp.2     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       st.b  sp.3     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       st.b  sp.4     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       st.b  sp.5     3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using named lists to have good column headings</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">getDensity</span> <span class="op">(</span>value       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>density<span class="op">=</span><span class="va">density</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              descriptor  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>station<span class="op">=</span><span class="va">station</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              taxon       <span class="op">=</span> <span class="va">species</span>, </span></span>
<span class="r-in"><span>              averageOver <span class="op">=</span> <span class="va">replicate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station taxon density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    st.a  sp.1       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    st.a  sp.2       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    st.b  sp.3       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    st.b  sp.4       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    st.b  sp.5       3</span>
<span class="r-in"><span>                 </span></span>
<span class="r-in"><span><span class="co"># estimating proportions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">getProportion</span> <span class="op">(</span>value    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>density<span class="op">=</span><span class="va">density</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              descriptor  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>station<span class="op">=</span><span class="va">station</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              taxon       <span class="op">=</span> <span class="va">species</span>, </span></span>
<span class="r-in"><span>              averageOver <span class="op">=</span> <span class="va">replicate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station taxon         p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    st.a  sp.1 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    st.a  sp.2 0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    st.b  sp.3 0.4285714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    st.b  sp.4 0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    st.b  sp.5 0.4285714</span>
<span class="r-in"><span>                 </span></span>
<span class="r-in"><span><span class="co"># averaging multiple value columns at once </span></span></span>
<span class="r-in"><span><span class="co"># extending the data with biomass - assume no biomass for st b</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Bdata.rep</span><span class="op">$</span><span class="va">biomass</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Bdata.rep</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station replicate species density biomass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    st.a         1    sp.1       1     0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    st.a         1    sp.2       2     0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    st.a         2    sp.1       3     0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    st.b         1    sp.3       3      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    st.b         1    sp.4       1      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    st.b         1    sp.5       3      NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">getDensity</span> <span class="op">(</span>value       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>density<span class="op">=</span><span class="va">density</span>, biomass<span class="op">=</span><span class="va">biomass</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              descriptor  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>station<span class="op">=</span><span class="va">station</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              taxon       <span class="op">=</span> <span class="va">species</span>, </span></span>
<span class="r-in"><span>              averageOver <span class="op">=</span> <span class="va">replicate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station taxon density biomass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    st.a  sp.1       2     0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    st.a  sp.2       1     0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    st.b  sp.3       3      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    st.b  sp.4       1      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    st.b  sp.5       3      NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Select information for one species</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">getDensity</span> <span class="op">(</span>subset      <span class="op">=</span> <span class="va">species</span><span class="op">==</span><span class="st">"sp.2"</span>,</span></span>
<span class="r-in"><span>              value       <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>              descriptor  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>station<span class="op">=</span><span class="va">station</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              taxon       <span class="op">=</span> <span class="va">species</span>, </span></span>
<span class="r-in"><span>              averageOver <span class="op">=</span> <span class="va">replicate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station taxon value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    st.a  sp.2     1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># returns also the 0 value </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">getDensity</span> <span class="op">(</span>subset      <span class="op">=</span> <span class="va">species</span><span class="op">==</span><span class="st">"sp.2"</span>,</span></span>
<span class="r-in"><span>              value       <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>              descriptor  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>station<span class="op">=</span><span class="va">station</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              taxon       <span class="op">=</span> <span class="va">species</span>, </span></span>
<span class="r-in"><span>              averageOver <span class="op">=</span> <span class="va">replicate</span>, </span></span>
<span class="r-in"><span>              full.output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station taxon value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    st.a  sp.2     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    st.b  sp.2     0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Extend the long format with absences</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># take averages over replicates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">addAbsences</span> <span class="op">(</span>value      <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>               descriptor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">station</span>, <span class="va">replicate</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>               taxon      <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    station replicate taxon value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     st.a         1  sp.1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     st.b         1  sp.1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     st.a         2  sp.1     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     st.a         1  sp.2     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     st.b         1  sp.2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     st.a         2  sp.2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     st.a         1  sp.3     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     st.b         1  sp.3     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     st.a         2  sp.3     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    st.a         1  sp.4     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    st.b         1  sp.4     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    st.a         2  sp.4     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    st.a         1  sp.5     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    st.b         1  sp.5     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    st.a         2  sp.5     0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># keep replicates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">addAbsences</span> <span class="op">(</span>value       <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>               descriptor  <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>               taxon       <span class="op">=</span> <span class="va">species</span>, </span></span>
<span class="r-in"><span>               averageOver <span class="op">=</span> <span class="va">replicate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    descriptor taxon value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        st.a  sp.1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        st.b  sp.1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        st.a  sp.2     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        st.b  sp.2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        st.a  sp.3     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        st.b  sp.3     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        st.a  sp.4     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8        st.b  sp.4     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9        st.a  sp.5     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       st.b  sp.5     3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## A small dataset without replicates</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Bdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  station <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"st.a"</span>,<span class="st">"st.a"</span>,<span class="st">"st.b"</span>,<span class="st">"st.b"</span>,<span class="st">"st.b"</span>,<span class="st">"st.c"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.1"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.4"</span>,<span class="st">"sp.5"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Small dataset: taxonomy</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Btaxonomy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.4"</span>,<span class="st">"sp.5"</span>,<span class="st">"sp.6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  genus   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"g.1"</span>, <span class="st">"g.2"</span>, <span class="st">"g.2"</span>, <span class="st">"g.2"</span>, <span class="st">"g.3"</span>, <span class="st">"g.4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  family  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.2"</span>, <span class="st">"f.3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  order   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.2"</span>, <span class="st">"o.2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  class   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## density on higher taxonomic level</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># species density for a particular genus </span></span></span>
<span class="r-in"><span><span class="va">sp.g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata</span>, </span></span>
<span class="r-in"><span>  <span class="fu">getDensity</span><span class="op">(</span>descriptor <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>             taxon      <span class="op">=</span> <span class="va">species</span>,</span></span>
<span class="r-in"><span>             value      <span class="op">=</span> <span class="va">density</span>,</span></span>
<span class="r-in"><span>             taxonomy   <span class="op">=</span> <span class="va">Btaxonomy</span>,</span></span>
<span class="r-in"><span>             subset     <span class="op">=</span> <span class="va">genus</span> <span class="op">==</span> <span class="st">"g.2"</span><span class="op">)</span></span></span>
<span class="r-in"><span>              <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># select data for station st.a</span></span></span>
<span class="r-in"><span><span class="va">Bselect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata</span>, </span></span>
<span class="r-in"><span>   <span class="fu">getDensity</span> <span class="op">(</span>value      <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>               descriptor <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>               taxon      <span class="op">=</span> <span class="va">species</span>, </span></span>
<span class="r-in"><span>               subset     <span class="op">=</span> <span class="va">station</span><span class="op">==</span><span class="st">"st.a"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Bselect</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor taxon value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a  sp.1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.a  sp.2     2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># pass taxonomy to select only species that belong to g.1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata</span>, </span></span>
<span class="r-in"><span>   <span class="fu">getDensity</span> <span class="op">(</span>value      <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>               descriptor <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>               taxon      <span class="op">=</span> <span class="va">species</span>, </span></span>
<span class="r-in"><span>               taxonomy   <span class="op">=</span> <span class="va">Btaxonomy</span>, </span></span>
<span class="r-in"><span>               subset     <span class="op">=</span> <span class="va">genus</span><span class="op">==</span><span class="st">"g.1"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor taxon value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a  sp.1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b  sp.1     3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Northsea dataset</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Occurrence of Abra alba, averaged per station</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Abra_alba</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">density</span>, </span></span>
<span class="r-in"><span>   <span class="fu">getDensity</span><span class="op">(</span>subset      <span class="op">=</span> <span class="va">taxon</span><span class="op">==</span><span class="st">"Abra alba"</span>,</span></span>
<span class="r-in"><span>              descriptor  <span class="op">=</span> <span class="va">station</span>,</span></span>
<span class="r-in"><span>              averageOver <span class="op">=</span> <span class="va">year</span>,</span></span>
<span class="r-in"><span>              taxon       <span class="op">=</span> <span class="va">taxon</span>,</span></span>
<span class="r-in"><span>              value       <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Abra_alba</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor     taxon      value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  BREEVTN02 Abra alba 55.6795892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  BREEVTN04 Abra alba  0.6747638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  BREEVTN07 Abra alba  0.7684211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  BREEVTN08 Abra alba  3.5663961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  BREEVTN09 Abra alba  0.6747632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  BREEVTN10 Abra alba  0.6747632</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mean of all Abra species over all stations</span></span></span>
<span class="r-in"><span><span class="co"># This should be done in two steps.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Abra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">density</span>, </span></span>
<span class="r-in"><span>   <span class="fu">getDensity</span><span class="op">(</span>subset      <span class="op">=</span> <span class="va">genus</span><span class="op">==</span><span class="st">"Abra"</span>,</span></span>
<span class="r-in"><span>              descriptor  <span class="op">=</span> <span class="va">station</span>,</span></span>
<span class="r-in"><span>              averageOver <span class="op">=</span> <span class="va">year</span>,</span></span>
<span class="r-in"><span>              taxon       <span class="op">=</span> <span class="va">taxon</span>,</span></span>
<span class="r-in"><span>              taxonomy    <span class="op">=</span> <span class="va">Taxonomy</span>,</span></span>
<span class="r-in"><span>              value       <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>              full.output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Abra</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor           taxon     value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  BREEVTN02       Abra alba 55.679589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  BREEVTN02     Abra nitida  1.349526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  BREEVTN02 Abra prismatica  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  BREEVTN02     Abra tenuis  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  BREEVTN03       Abra alba  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  BREEVTN03     Abra nitida  0.000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">Abra</span><span class="op">$</span><span class="va">value</span>, INDEX<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Abra</span><span class="op">$</span><span class="va">taxon</span><span class="op">)</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Abra alba     Abra nitida Abra prismatica     Abra tenuis </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      22.0298979       1.1496596       0.9196846       0.0196533 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Karline Soetaert.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

