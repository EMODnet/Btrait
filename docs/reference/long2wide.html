<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="long2wide casts data from long to wide format.
w2lDensity casts density data from wide to long format.
w2lTrait casts trait data from wide to long format.
wide2long casts data from wide to long format.
l2wDensity casts density data from long to wide format.
l2wTrait casts trait data from long to wide format."><title>Functions for conversion from long to wide format and vice versa. — Conversion functions • Btrait</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functions for conversion from long to wide format and vice versa. — Conversion functions"><meta property="og:description" content="long2wide casts data from long to wide format.
w2lDensity casts density data from wide to long format.
w2lTrait casts trait data from wide to long format.
wide2long casts data from wide to long format.
l2wDensity casts density data from long to wide format.
l2wTrait casts trait data from long to wide format."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Btrait</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/Btrait.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BtraitData.html">Benthic density and trait databases in R-package Btrait</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Functions for conversion from long to wide format and vice versa.</h1>
      
      <div class="d-none name"><code>long2wide.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>long2wide</code> casts data from long to wide format.</p>
<p><code>w2lDensity</code> casts density data from wide to long format.</p>
<p><code>w2lTrait</code> casts trait data from wide to long format.</p>
<p><code>wide2long</code> casts data from wide to long format.</p>
<p><code>l2wDensity</code> casts density data from long to wide format.</p>
<p><code>l2wTrait</code> casts trait data from long to wide format.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wide2long</span><span class="op">(</span><span class="va">wide</span>, d.column <span class="op">=</span> <span class="fl">1</span>, w.names <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>          absences <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">w2lDensity</span><span class="op">(</span><span class="va">wide</span>, d.column <span class="op">=</span> <span class="fl">1</span>, taxon.names <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>           absences <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">w2lTrait</span><span class="op">(</span><span class="va">wide</span>, t.column <span class="op">=</span> <span class="fl">1</span>, trait.names <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>           absences <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">long2wide</span><span class="op">(</span><span class="va">row</span>, <span class="va">column</span>, <span class="va">value</span>, averageOver <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>        taxonomy <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">subset</span><span class="op">)</span></span>
<span>        </span>
<span><span class="fu">l2wDensity</span><span class="op">(</span><span class="va">descriptor</span>, <span class="va">taxon</span>, <span class="va">value</span>, averageOver <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>        taxonomy <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">subset</span><span class="op">)</span></span>
<span>        </span>
<span><span class="fu">l2wTrait</span><span class="op">(</span><span class="va">trait</span>, <span class="va">taxon</span>, <span class="va">value</span>, averageOver <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>        taxonomy <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">subset</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>wide </dt>
<dd><p>data, in *WIDE* format. For density data, this is a data.frame or matrix with (descriptor x taxon) information (for density data), and The first column usually contains the descriptor name. For trait data this is a data.frame with (taxon x trait) information, and the first column generally contains the names of the taxa. It is also allowed to have the descriptors as row.names of the data.frame -this requires setting <code>d.column=0</code>.</p></dd>

  <dt>row </dt>
<dd><p>vector or data.frame that contains the data that will be used to label the rows in wide format. This can consist of multiple colums.</p></dd>
    
  <dt>column </dt>
<dd><p>vector with the data that will be used to label the columns in wide format.</p></dd>
    
  <dt>descriptor </dt>
<dd><p>name(s) of the descriptor, i.e. *where* the data were taken, e.g. station names. Either a vector, a list, a data.frame or matrix (and with multiple columns). It can be of type numerical, character, or a factor. When a data.frame or a list the "names" will be used in the output; when a vector, the argument name will be used in the output.</p></dd>
    
  <dt>taxon </dt>
<dd><p>gives the taxonomic name(s) (e.g. species). Should be of the same length as (the number of rows of) <code>descriptor</code>. Can be a list (or data.frame with one column), or a vector. When a data.frame or a list the "name" of the column will be used in the output; when a vector, the argument name will be used.</p></dd>

  <dt>value </dt>
<dd><p>vector or list that contains the *values* of the data, usually density. Should be of the same length as (the number of rows of) <code>descriptor</code> and <code>taxon</code>. For function <code>getDensity</code>, <code>value</code> can also be a multi-column data.frame or matrix.</p></dd>

  <dt>averageOver </dt>
<dd><p>vector with *replicates* over which averages need to be taken. Should be of the same length as (the number of rows of) <code>descriptor</code>.</p></dd>

  <dt>subset </dt>
<dd><p>logical expression indicating elements to keep: missing values are taken as FALSE. If NULL, or absent, then all elements are used. Note that the subset is taken *after* the number of samples to average per descriptor is calculated, so this will also work for selecting certain taxa that may not be present in all replicates over which should be averaged.</p></dd>

  <dt>taxonomy </dt>
<dd><p>taxonomic information; first column will be matched with <code>taxon</code>, regardless of its name.</p></dd>

  <dt>d.column </dt>
<dd><p>position(s) or name(s) of the column(s) that holds the descriptors of the (density) data set, and that should be removed for any calculations. The default is to have the first column holding the descriptors. If <code>NULL</code>, or <code>0</code>, then there is no separate column with names, so the <code>row.names</code> of the dataset are used as descriptor names.</p></dd>

  <dt>t.column </dt>
<dd><p>position(s) or name(s) of the column(s) that holds the taxon names of the (trait) data set, and that should be removed for any calculations. The default is to have the first column holding the taxa. If <code>NULL</code>, or <code>0</code>, then there is no separate column with names, so the <code>row.names</code> of the dataset are used as taxon names.</p></dd>

  
  <dt>trait </dt>
<dd><p>(taxon x trait) data or (descriptor x trait) data, in WIDE format. Traits can be fuzzy coded. In the default setting, the first column contains the name of the taxon, and <code>t.column=1</code>. It is also allowed to have the taxa as <code>row.names</code> of the data.frame - set <code>t.column=0</code>.</p></dd>

  <dt>w.names, taxon.names, trait.names </dt>
<dd><p>names of the items constituting the columns in the wide dataset. If not given, the columnames (minus d.column) will be used. Input this as a data.frame if you want to set the names of the columns in the long format.</p></dd>

  <dt>absences </dt>
<dd><p>if <code>TRUE</code> the long format will contains 0's for absences</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="MWTLdensitydata.html">MWTL</a> for the data sets</p>
<p><a href="BtraitMap.html">mapBtrait</a> for simple plotting functions</p>
<p><a href="densityfun.html">getDensity</a> for functions working on density data</p>
<p><a href="summary.html">getSummary</a> for estimating summaries from density data</p>
<p><a href="getTraitDensity.html">getTraitDensity</a> for functions combining density and traits</p>
<p><a href="getIndices.html">getDbIndex</a> for extracting bioturbation and bioirrigation indices</p>
<p><a href="traitfun.html">extendTrait</a> for functions working with traits</p>
<p><a href="traitfun.html">getTrait</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>About <code>long2wide</code> and <code>wide2long</code>:</p>
<p>There are two ways in which density data can be inputted:</p>
<ul><li><p>descriptor, taxon, value, replicates, ... are vectors with density data in *LONG* format: (where, which, replicates (averageOver), value); all these vectors should be of equal length (or NULL).</p></li>
<li><p>wide has the density data in *WIDE* format, i.e. as a matrix with the descriptor (and perhaps replicates) in the first column, the taxon as the column names (excluding the first column), and the content of the data is the density.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Long to wide format</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## A small dataset with replicates</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2 stations, 2 replicates for st.a, one replicate for st.b</span></span></span>
<span class="r-in"><span><span class="va">Bdata.rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  station   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"st.a"</span>,<span class="st">"st.a"</span>,<span class="st">"st.a"</span>,<span class="st">"st.b"</span>,<span class="st">"st.b"</span>,<span class="st">"st.b"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  replicate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>     <span class="fl">1</span>,     <span class="fl">1</span>,    <span class="fl">2</span>,     <span class="fl">1</span>,     <span class="fl">1</span>,     <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  species   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.1"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.4"</span>,<span class="st">"sp.5"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  density   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>     <span class="fl">1</span>,     <span class="fl">2</span>,    <span class="fl">3</span>,     <span class="fl">3</span>,     <span class="fl">1</span>,     <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Bdata.rep</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station replicate species density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    st.a         1    sp.1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    st.a         1    sp.2       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    st.a         2    sp.1       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    st.b         1    sp.3       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    st.b         1    sp.4       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    st.b         1    sp.5       3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Go to wide format, average of replicates</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">l2wDensity</span><span class="op">(</span>value      <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>            descriptor  <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>            taxon       <span class="op">=</span> <span class="va">species</span>, </span></span>
<span class="r-in"><span>            averageOver <span class="op">=</span> <span class="va">replicate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor sp.1 sp.2 sp.3 sp.4 sp.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a    2    1    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b    0    0    3    1    3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Go to wide format, keep replicates</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">l2wDensity</span><span class="op">(</span>value      <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>            descriptor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">station</span>, <span class="va">replicate</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>            taxon      <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station replicate sp.1 sp.2 sp.3 sp.4 sp.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    st.a         1    1    2    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    st.b         1    0    0    3    1    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    st.a         2    3    0    0    0    0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Go to wide format, ADD replicates</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.rep</span>, </span></span>
<span class="r-in"><span>  <span class="fu">l2wDensity</span><span class="op">(</span>value      <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>            descriptor <span class="op">=</span> <span class="va">station</span>,  </span></span>
<span class="r-in"><span>            taxon      <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor sp.1 sp.2 sp.3 sp.4 sp.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a    4    2    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b    0    0    3    1    3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## A small dataset without replicates</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Bdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  station <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"st.a"</span>,<span class="st">"st.a"</span>,<span class="st">"st.b"</span>,<span class="st">"st.b"</span>,<span class="st">"st.b"</span>,<span class="st">"st.c"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.1"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.4"</span>,<span class="st">"sp.5"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## From long to wide format</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Bwide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata</span>, </span></span>
<span class="r-in"><span>  <span class="fu">l2wDensity</span> <span class="op">(</span>value      <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>             descriptor <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>             taxon      <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Bwide</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor sp.1 sp.2 sp.3 sp.4 sp.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a    1    2    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b    3    0    3    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       st.c    0    0    0    0    3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Small dataset: taxonomy</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Btaxonomy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.4"</span>,<span class="st">"sp.5"</span>,<span class="st">"sp.6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  genus   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"g.1"</span>, <span class="st">"g.2"</span>, <span class="st">"g.2"</span>, <span class="st">"g.2"</span>, <span class="st">"g.3"</span>, <span class="st">"g.4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  family  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.2"</span>, <span class="st">"f.3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  order   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.2"</span>, <span class="st">"o.2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  class   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## density on higher taxonomic level</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add genus, family... to the density data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Bdata.ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Bdata</span>, <span class="va">Btaxonomy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Bdata.ext</span><span class="op">)</span>   </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   species station density genus family order class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    sp.1    st.a       1   g.1    f.1   o.1   c.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    sp.1    st.b       3   g.1    f.1   o.1   c.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    sp.2    st.a       2   g.2    f.1   o.1   c.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    sp.3    st.b       3   g.2    f.1   o.1   c.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    sp.4    st.b       1   g.2    f.1   o.1   c.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    sp.5    st.c       3   g.3    f.2   o.2   c.1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate (summed) density on genus level </span></span></span>
<span class="r-in"><span><span class="va">Bwide.genus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.ext</span>, </span></span>
<span class="r-in"><span>  <span class="fu">l2wDensity</span><span class="op">(</span>descriptor <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>             taxon      <span class="op">=</span> <span class="va">genus</span>,</span></span>
<span class="r-in"><span>             value      <span class="op">=</span> <span class="va">density</span><span class="op">)</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Bwide.genus</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor g.1 g.2 g.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a   1   2   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b   3   4   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       st.c   0   0   3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## select part of the data</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># return species density for g.2 only</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.ext</span>, </span></span>
<span class="r-in"><span>  <span class="fu">l2wDensity</span><span class="op">(</span>value     <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>            descriptor <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>            taxon      <span class="op">=</span> <span class="va">species</span>, </span></span>
<span class="r-in"><span>            subset     <span class="op">=</span> <span class="va">genus</span><span class="op">==</span><span class="st">"g.2"</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor sp.2 sp.3 sp.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a    2    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b    0    3    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create summed values for g.2 only</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">Bdata.ext</span>, </span></span>
<span class="r-in"><span>  <span class="fu">l2wDensity</span><span class="op">(</span>value     <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>            descriptor <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>            taxon      <span class="op">=</span> <span class="va">genus</span>, </span></span>
<span class="r-in"><span>            subset     <span class="op">=</span> <span class="va">genus</span><span class="op">==</span><span class="st">"g.2"</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   descriptor g.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       st.a   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       st.b   4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## From wide to long format</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Bwide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>station<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sta"</span>, <span class="st">"Stb"</span>, <span class="st">"Stc"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    sp1    <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    <span class="fl">1</span>,     <span class="fl">3</span>,     <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    sp2    <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    <span class="fl">2</span>,     <span class="fl">0</span>,     <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    sp3    <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    <span class="fl">0</span>,     <span class="fl">0</span>,     <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this long format includes the 0 densities</span></span></span>
<span class="r-in"><span><span class="fu">wide2long</span> <span class="op">(</span>wide <span class="op">=</span> <span class="va">Bwide</span>, absences<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station name value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     Sta  sp1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     Stb  sp1     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     Stc  sp1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     Sta  sp2     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     Stb  sp2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     Stc  sp2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     Sta  sp3     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     Stb  sp3     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     Stc  sp3     3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this labels the species column appropriately</span></span></span>
<span class="r-in"><span><span class="fu">wide2long</span> <span class="op">(</span>wide <span class="op">=</span> <span class="va">Bwide</span>, w.name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>species<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Bwide</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station species value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     Sta     sp1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     Stb     sp1     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     Sta     sp2     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     Stc     sp3     3</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Karline Soetaert.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

